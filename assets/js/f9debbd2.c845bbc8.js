"use strict";(self.webpackChunklineage_ai_user_doc=self.webpackChunklineage_ai_user_doc||[]).push([[9511],{4774:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>u,frontMatter:()=>c,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"deploy/start","title":"Deploy on public cloud","description":"You need to get access to our private docker image repository by contacting our team","source":"@site/docs/deploy/start.md","sourceDirName":"deploy","slug":"/deploy/start","permalink":"/lineage-ai-user-doc/docs/deploy/start","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/deploy/start.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"deploySidebar","previous":{"title":"Deployment Overview","permalink":"/lineage-ai-user-doc/docs/deploy/intro"},"next":{"title":"Environment Variables Reference","permalink":"/lineage-ai-user-doc/docs/deploy/env"}}');var i=r(4848),l=r(8453);const c={sidebar_position:2},t="Deploy on public cloud",o={},a=[{value:"Deploy on Azure VMs with GCP Artifact Registry Access",id:"deploy-on-azure-vms-with-gcp-artifact-registry-access",level:2},{value:"1. Set up Azure Virtual Machines",id:"1-set-up-azure-virtual-machines",level:3},{value:"2. Install Dependencies",id:"2-install-dependencies",level:3},{value:"3. Configure GCP Authentication",id:"3-configure-gcp-authentication",level:3},{value:"4. Deploy Containers",id:"4-deploy-containers",level:3},{value:"5. Verify Deployment",id:"5-verify-deployment",level:3},{value:"Deploy on GCP Compute Engine",id:"deploy-on-gcp-compute-engine",level:2},{value:"1. Set up GCP Compute Engine VMs",id:"1-set-up-gcp-compute-engine-vms",level:3},{value:"2. Create Compute Engine Instances",id:"2-create-compute-engine-instances",level:3},{value:"3. Install Dependencies",id:"3-install-dependencies",level:3},{value:"4. Configure Docker Authentication",id:"4-configure-docker-authentication",level:3},{value:"5. Deploy Containers",id:"5-deploy-containers",level:3},{value:"6. Configure Firewall Rules",id:"6-configure-firewall-rules",level:3},{value:"7. Verify Deployment",id:"7-verify-deployment",level:3},{value:"Deploy on AWS EC2",id:"deploy-on-aws-ec2",level:2},{value:"1. Set up AWS EC2 Instances",id:"1-set-up-aws-ec2-instances",level:3},{value:"2. Launch EC2 Instances",id:"2-launch-ec2-instances",level:3},{value:"3. Configure Security Groups",id:"3-configure-security-groups",level:3},{value:"4. Install Dependencies",id:"4-install-dependencies",level:3},{value:"5. Deploy Containers",id:"5-deploy-containers-1",level:3},{value:"6. Verify Deployment",id:"6-verify-deployment",level:3}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"deploy-on-public-cloud",children:"Deploy on public cloud"})}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsx)(n.mdxAdmonitionTitle,{}),(0,i.jsx)(n.p,{children:"You need to get access to our private docker image repository by contacting our team\r\nbefore following the steps."})]}),"\n",(0,i.jsx)(n.h2,{id:"deploy-on-azure-vms-with-gcp-artifact-registry-access",children:"Deploy on Azure VMs with GCP Artifact Registry Access"}),"\n",(0,i.jsx)(n.p,{children:"This section explains how to deploy Lineage AI on Azure VMs"}),"\n",(0,i.jsx)(n.h3,{id:"1-set-up-azure-virtual-machines",children:"1. Set up Azure Virtual Machines"}),"\n",(0,i.jsx)(n.p,{children:"Create three VMs according to the specifications in the deployment overview:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Frontend VM"})," (Standard_D2s_v3):"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"2 vCPUs, 8GB RAM"}),"\n",(0,i.jsx)(n.li,{children:"Ubuntu Server 20.04 LTS"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Backend VM"})," (Standard_D2s_v3):"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"2 vCPUs, 8GB RAM"}),"\n",(0,i.jsx)(n.li,{children:"Ubuntu Server 20.04 LTS"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"LLM Service VM"})," (NC24ads_A100_v4):"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"8+ vCPUs, 100GB+ RAM"}),"\n",(0,i.jsx)(n.li,{children:"Ubuntu Server 20.04 LTS"}),"\n",(0,i.jsx)(n.li,{children:"8x NVIDIA A100 GPUs"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"2-install-dependencies",children:"2. Install Dependencies"}),"\n",(0,i.jsx)(n.p,{children:"On all VMs:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Install Docker\r\ncurl -fsSL https://get.docker.com -o get-docker.sh\r\nsudo sh get-docker.sh\r\n\r\n# Install Google Cloud SDK\r\ncurl https://sdk.cloud.google.com | bash\r\nexec -l $SHELL\r\ngcloud init\n"})}),"\n",(0,i.jsx)(n.p,{children:"On LLM Service VM, additionally:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Install NVIDIA Container Toolkit\r\ndistribution=$(. /etc/os-release;echo $ID$VERSION_ID)\r\ncurl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add -\r\ncurl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list | sudo tee /etc/apt/sources.list.d/nvidia-docker.list\r\nsudo apt-get update && sudo apt-get install -y nvidia-container-toolkit\r\nsudo systemctl restart docker\n"})}),"\n",(0,i.jsx)(n.h3,{id:"3-configure-gcp-authentication",children:"3. Configure GCP Authentication"}),"\n",(0,i.jsx)(n.p,{children:"On each VM:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Configure Docker with GCP credentials\r\ngcloud auth configure-docker gcr.io\n"})}),"\n",(0,i.jsx)(n.h3,{id:"4-deploy-containers",children:"4. Deploy Containers"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Frontend (UI) Deployment"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker pull gcr.io/ivory-signer-435502-f9/lineage-frontend:latest\r\ndocker run -d -p 3000:3000 \\\r\n  -e NEXT_PUBLIC_API_TOKEN=your_token \\\r\n  -e NEXT_PUBLIC_API_BASE_URL=http://backend-vm-ip:8081 \\\r\n  gcr.io/ivory-signer-435502-f9/lineage-frontend:latest\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Backend (LLM API) Deployment"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker pull gcr.io/ivory-signer-435502-f9/lineage-llm:latest\r\ndocker run -d -p 8081:8081 \\\r\n  -e FLASK_ENV=production \\\r\n  -e DB_HOST=your_db_host \\\r\n  -e DB_PORT=your_db_port \\\r\n  -e DB_NAME=your_db_name \\\r\n  -e DB_USER=your_db_user \\\r\n  -e DB_PASSWORD=your_db_password \\\r\n  gcr.io/ivory-signer-435502-f9/lineage-llm:latest\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"LLM Service Deployment"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker pull gcr.io/ivory-signer-435502-f9/lineage-llm-service:latest\r\ndocker run -d --gpus all -p 8000:8000 \\\r\n  gcr.io/ivory-signer-435502-f9/lineage-llm-service:latest\n"})}),"\n",(0,i.jsx)(n.h3,{id:"5-verify-deployment",children:"5. Verify Deployment"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Check if containers are running:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker ps\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Test frontend access:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Open browser: ",(0,i.jsx)(n.code,{children:"http://frontend-vm-ip:3000"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Test backend health:"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl http://backend-vm-ip:8081/health\n"})}),"\n",(0,i.jsx)(n.h2,{id:"deploy-on-gcp-compute-engine",children:"Deploy on GCP Compute Engine"}),"\n",(0,i.jsx)(n.h3,{id:"1-set-up-gcp-compute-engine-vms",children:"1. Set up GCP Compute Engine VMs"}),"\n",(0,i.jsx)(n.p,{children:"Create three VMs according to the specifications in the deployment overview:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Frontend VM"})," (e2-standard-2):"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"2 vCPUs"}),"\n",(0,i.jsx)(n.li,{children:"8GB RAM"}),"\n",(0,i.jsx)(n.li,{children:"Ubuntu Server 20.04 LTS"}),"\n",(0,i.jsx)(n.li,{children:"10GB boot disk"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Backend VM"})," (e2-standard-2):"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"2 vCPUs"}),"\n",(0,i.jsx)(n.li,{children:"8GB RAM"}),"\n",(0,i.jsx)(n.li,{children:"Ubuntu Server 20.04 LTS"}),"\n",(0,i.jsx)(n.li,{children:"10GB boot disk"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"LLM Service VM"})," (a2-highgpu-8g):"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"12 vCPUs"}),"\n",(0,i.jsx)(n.li,{children:"85GB RAM"}),"\n",(0,i.jsx)(n.li,{children:"Ubuntu Server 20.04 LTS"}),"\n",(0,i.jsx)(n.li,{children:"200GB boot disk"}),"\n",(0,i.jsx)(n.li,{children:"8x NVIDIA A100 GPUs"}),"\n",(0,i.jsx)(n.li,{children:"GPU memory: 40GB per GPU"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"2-create-compute-engine-instances",children:"2. Create Compute Engine Instances"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Create Frontend VM"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"gcloud compute instances create lineage-frontend \\\r\n  --machine-type=e2-standard-2 \\\r\n  --zone=us-central1-a \\\r\n  --image-family=ubuntu-2004-lts \\\r\n  --image-project=ubuntu-os-cloud \\\r\n  --boot-disk-size=10GB \\\r\n  --service-account=lineage-compute-sa@${PROJECT_ID}.iam.gserviceaccount.com \\\r\n  --scopes=cloud-platform\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Create Backend VM"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"gcloud compute instances create lineage-backend \\\r\n  --machine-type=e2-standard-2 \\\r\n  --zone=us-central1-a \\\r\n  --image-family=ubuntu-2004-lts \\\r\n  --image-project=ubuntu-os-cloud \\\r\n  --boot-disk-size=10GB \\\r\n  --service-account=lineage-compute-sa@${PROJECT_ID}.iam.gserviceaccount.com \\\r\n  --scopes=cloud-platform\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Create LLM Service VM"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'gcloud compute instances create lineage-llm-service \\\r\n  --machine-type=a2-highgpu-8g \\\r\n  --zone=us-central1-a \\\r\n  --image-family=ubuntu-2004-lts \\\r\n  --image-project=ubuntu-os-cloud \\\r\n  --boot-disk-size=200GB \\\r\n  --maintenance-policy=TERMINATE \\\r\n  --accelerator="type=nvidia-tesla-a100,count=8" \\\r\n  --metadata="install-nvidia-driver=True" \\\r\n  --service-account=lineage-compute-sa@${PROJECT_ID}.iam.gserviceaccount.com \\\r\n  --scopes=cloud-platform\n'})}),"\n",(0,i.jsx)(n.h3,{id:"3-install-dependencies",children:"3. Install Dependencies"}),"\n",(0,i.jsx)(n.p,{children:"Connect to each instance:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"gcloud compute ssh INSTANCE_NAME --zone=us-central1-a\n"})}),"\n",(0,i.jsx)(n.p,{children:"On all instances:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Install Docker\r\ncurl -fsSL https://get.docker.com -o get-docker.sh\r\nsudo sh get-docker.sh\n"})}),"\n",(0,i.jsx)(n.p,{children:"On LLM Service instance, additionally:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Install NVIDIA Container Toolkit\r\ndistribution=$(. /etc/os-release;echo $ID$VERSION_ID)\r\ncurl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add -\r\ncurl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list | sudo tee /etc/apt/sources.list.d/nvidia-docker.list\r\nsudo apt-get update && sudo apt-get install -y nvidia-container-toolkit\r\nsudo systemctl restart docker\n"})}),"\n",(0,i.jsx)(n.h3,{id:"4-configure-docker-authentication",children:"4. Configure Docker Authentication"}),"\n",(0,i.jsx)(n.p,{children:"On each instance:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Configure Docker credential helper\r\nsudo apt-get install -y google-cloud-sdk-docker-credential-gcr\r\n\r\n# Configure Docker\r\nmkdir -p ~/.docker\r\necho \'{\r\n  "credHelpers": {\r\n    "gcr.io": "gcr"\r\n  }\r\n}\' > ~/.docker/config.json\r\n\r\n# The service account credentials will be automatically used\n'})}),"\n",(0,i.jsx)(n.h3,{id:"5-deploy-containers",children:"5. Deploy Containers"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Frontend (UI) Deployment"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker pull gcr.io/ivory-signer-435502-f9/lineage-frontend:latest\r\ndocker run -d -p 3000:3000 \\\r\n  -e NEXT_PUBLIC_API_TOKEN=your_token \\\r\n  -e NEXT_PUBLIC_API_BASE_URL=http://BACKEND_INTERNAL_IP:8081 \\\r\n  gcr.io/ivory-signer-435502-f9/lineage-frontend:latest\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Backend (LLM API) Deployment"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker pull gcr.io/ivory-signer-435502-f9/lineage-llm:latest\r\ndocker run -d -p 8081:8081 \\\r\n  -e FLASK_ENV=production \\\r\n  -e DB_HOST=your_db_host \\\r\n  -e DB_PORT=your_db_port \\\r\n  -e DB_NAME=your_db_name \\\r\n  -e DB_USER=your_db_user \\\r\n  -e DB_PASSWORD=your_db_password \\\r\n  gcr.io/ivory-signer-435502-f9/lineage-llm:latest\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"LLM Service Deployment"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker pull gcr.io/ivory-signer-435502-f9/lineage-llm-service:latest\r\ndocker run -d --gpus all -p 8000:8000 \\\r\n  gcr.io/ivory-signer-435502-f9/lineage-llm-service:latest\n"})}),"\n",(0,i.jsx)(n.h3,{id:"6-configure-firewall-rules",children:"6. Configure Firewall Rules"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Allow incoming traffic to frontend\r\ngcloud compute firewall-rules create allow-frontend \\\r\n  --allow tcp:3000 \\\r\n  --target-tags=lineage-frontend\r\n\r\n# Allow incoming traffic to backend\r\ngcloud compute firewall-rules create allow-backend \\\r\n  --allow tcp:8081 \\\r\n  --target-tags=lineage-backend\r\n\r\n# Allow incoming traffic to LLM service\r\ngcloud compute firewall-rules create allow-llm-service \\\r\n  --allow tcp:8000 \\\r\n  --target-tags=lineage-llm-service\n"})}),"\n",(0,i.jsx)(n.h3,{id:"7-verify-deployment",children:"7. Verify Deployment"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Check container status on each instance:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker ps\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Test frontend access:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Open browser: ",(0,i.jsx)(n.code,{children:"http://FRONTEND_EXTERNAL_IP:3000"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Test backend health:"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl http://BACKEND_EXTERNAL_IP:8081/health\n"})}),"\n",(0,i.jsx)(n.h2,{id:"deploy-on-aws-ec2",children:"Deploy on AWS EC2"}),"\n",(0,i.jsx)(n.h3,{id:"1-set-up-aws-ec2-instances",children:"1. Set up AWS EC2 Instances"}),"\n",(0,i.jsx)(n.p,{children:"Create three instances according to the specifications in the deployment overview:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Frontend Instance"})," (t3.medium):"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"2 vCPUs"}),"\n",(0,i.jsx)(n.li,{children:"4GB RAM"}),"\n",(0,i.jsx)(n.li,{children:"Ubuntu Server 20.04 LTS AMI"}),"\n",(0,i.jsx)(n.li,{children:"10GB EBS volume"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Backend Instance"})," (t3.medium):"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"2 vCPUs"}),"\n",(0,i.jsx)(n.li,{children:"4GB RAM"}),"\n",(0,i.jsx)(n.li,{children:"Ubuntu Server 20.04 LTS AMI"}),"\n",(0,i.jsx)(n.li,{children:"10GB EBS volume"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"LLM Service Instance"})," (p4d.24xlarge):"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"96 vCPUs"}),"\n",(0,i.jsx)(n.li,{children:"1,152GB RAM"}),"\n",(0,i.jsx)(n.li,{children:"Ubuntu Server 20.04 LTS AMI"}),"\n",(0,i.jsx)(n.li,{children:"200GB EBS volume"}),"\n",(0,i.jsx)(n.li,{children:"8x NVIDIA A100 GPUs"}),"\n",(0,i.jsx)(n.li,{children:"GPU memory: 40GB per GPU"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"2-launch-ec2-instances",children:"2. Launch EC2 Instances"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Frontend Instance"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"aws ec2 run-instances \\\r\n  --image-id ami-0c7217cdde317cfec \\\r\n  --instance-type t3.medium \\\r\n  --key-name your-key-pair \\\r\n  --security-group-ids your-security-group \\\r\n  --subnet-id your-subnet \\\r\n  --tag-specifications 'ResourceType=instance,Tags=[{Key=Name,Value=lineage-frontend}]' \\\r\n  --count 1\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Backend Instance"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"aws ec2 run-instances \\\r\n  --image-id ami-0c7217cdde317cfec \\\r\n  --instance-type t3.medium \\\r\n  --key-name your-key-pair \\\r\n  --security-group-ids your-security-group \\\r\n  --subnet-id your-subnet \\\r\n  --tag-specifications 'ResourceType=instance,Tags=[{Key=Name,Value=lineage-backend}]' \\\r\n  --count 1\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"LLM Service Instance"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"aws ec2 run-instances \\\r\n  --image-id ami-0c7217cdde317cfec \\\r\n  --instance-type p4d.24xlarge \\\r\n  --key-name your-key-pair \\\r\n  --security-group-ids your-security-group \\\r\n  --subnet-id your-subnet \\\r\n  --tag-specifications 'ResourceType=instance,Tags=[{Key=Name,Value=lineage-llm}]' \\\r\n  --count 1\n"})}),"\n",(0,i.jsx)(n.h3,{id:"3-configure-security-groups",children:"3. Configure Security Groups"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Create security group\r\naws ec2 create-security-group \\\r\n  --group-name lineage-sg \\\r\n  --description "Security group for Lineage AI"\r\n\r\n# Allow frontend access\r\naws ec2 authorize-security-group-ingress \\\r\n  --group-name lineage-sg \\\r\n  --protocol tcp \\\r\n  --port 3000 \\\r\n  --cidr 0.0.0.0/0\r\n\r\n# Allow backend access\r\naws ec2 authorize-security-group-ingress \\\r\n  --group-name lineage-sg \\\r\n  --protocol tcp \\\r\n  --port 8081 \\\r\n  --cidr 0.0.0.0/0\r\n\r\n# Allow LLM service access\r\naws ec2 authorize-security-group-ingress \\\r\n  --group-name lineage-sg \\\r\n  --protocol tcp \\\r\n  --port 8000 \\\r\n  --cidr 0.0.0.0/0\n'})}),"\n",(0,i.jsx)(n.h3,{id:"4-install-dependencies",children:"4. Install Dependencies"}),"\n",(0,i.jsx)(n.p,{children:"Connect to each instance:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'ssh -i "your-key.pem" ubuntu@INSTANCE_PUBLIC_DNS\n'})}),"\n",(0,i.jsx)(n.p,{children:"On all instances:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Install Docker\r\ncurl -fsSL https://get.docker.com -o get-docker.sh\r\nsudo sh get-docker.sh\n"})}),"\n",(0,i.jsx)(n.p,{children:"On LLM Service instance:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Install NVIDIA drivers and toolkit\r\nsudo apt-get update\r\nsudo apt-get install -y nvidia-driver-470\r\ndistribution=$(. /etc/os-release;echo $ID$VERSION_ID)\r\ncurl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add -\r\ncurl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list | sudo tee /etc/apt/sources.list.d/nvidia-docker.list\r\nsudo apt-get update && sudo apt-get install -y nvidia-container-toolkit\r\nsudo systemctl restart docker\n"})}),"\n",(0,i.jsx)(n.h3,{id:"5-deploy-containers-1",children:"5. Deploy Containers"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Frontend (UI) Deployment"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker pull gcr.io/ivory-signer-435502-f9/lineage-frontend:latest\r\ndocker run -d -p 3000:3000 \\\r\n  -e NEXT_PUBLIC_API_TOKEN=your_token \\\r\n  -e NEXT_PUBLIC_API_BASE_URL=http://BACKEND_PRIVATE_IP:8081 \\\r\n  gcr.io/ivory-signer-435502-f9/lineage-frontend:latest\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Backend (LLM API) Deployment"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker pull gcr.io/ivory-signer-435502-f9/lineage-llm:latest\r\ndocker run -d -p 8081:8081 \\\r\n  -e FLASK_ENV=production \\\r\n  -e DB_HOST=your_db_host \\\r\n  -e DB_PORT=your_db_port \\\r\n  -e DB_NAME=your_db_name \\\r\n  -e DB_USER=your_db_user \\\r\n  -e DB_PASSWORD=your_db_password \\\r\n  gcr.io/ivory-signer-435502-f9/lineage-llm:latest\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"LLM Service Deployment"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker pull gcr.io/ivory-signer-435502-f9/lineage-llm-service:latest\r\ndocker run -d --gpus all -p 8000:8000 \\\r\n  gcr.io/ivory-signer-435502-f9/lineage-llm-service:latest\n"})}),"\n",(0,i.jsx)(n.h3,{id:"6-verify-deployment",children:"6. Verify Deployment"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Check container status:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker ps\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Test frontend access:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Open browser: ",(0,i.jsx)(n.code,{children:"http://FRONTEND_PUBLIC_DNS:3000"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Test backend health:"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl http://BACKEND_PUBLIC_DNS:8081/health\n"})})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>t});var s=r(6540);const i={},l=s.createContext(i);function c(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);